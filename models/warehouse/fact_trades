WITH raw AS (
  SELECT
    *
    ,ROW_NUMBER() OVER (PARTITION BY trade_id ORDER BY trade_updated_time DESC) AS rn -- take latest data
  FROM stg_trades
)

SELECT
  trade_id
  ,user_id
  ,token_id
  ,side
  ,price_usd
  ,quantity
  ,status
  ,trade_created_time
  ,trade_updated_time
FROM raw
WHERE 1=1
  AND rn = 1
